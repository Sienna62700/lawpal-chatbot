<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hong Kong Employment Law Assistant | 香港勞工法助手</title>
    <!-- Add Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Embedded CSS -->
    <style>
        /* Enhanced styling for the Hong Kong Employment Law chatbot */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background-color: #f8f3e6; /* Warmer background color matching your icon's theme */
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px; /* Increased container width */
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background-color: #2c3e50;
            color: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        header h1 {
            margin-bottom: 5px;
            font-size: 2.2rem;
        }
        
        header h2 {
            margin-bottom: 15px;
            font-size: 1.7rem;
            font-weight: normal;
            opacity: 0.9;
        }

        header p {
            font-size: 1.1rem;
            max-width: 80%;
            margin: 0 auto;
        }

        /* Robot icon styling based on your image */
        .logo-container {
            margin: 0 auto 15px;
            width: 180px;
            height: 180px;
            position: relative;
        }

        .chat-container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
            overflow: hidden;
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
        }

        .chat-messages {
            height: 500px; /* Increased height */
            overflow-y: auto;
            padding: 25px;
            scroll-behavior: smooth;
        }

        .message {
            margin-bottom: 20px;
            padding: 15px 20px;
            border-radius: 18px;
            max-width: 85%;
            word-wrap: break-word;
            line-height: 1.5;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .bot-message {
            background-color: #e6f2ff;
            margin-right: auto;
            border-bottom-left-radius: 5px;
            color: #2c3e50;
        }

        .user-message {
            background-color: #dcf8c6;
            margin-left: auto;
            text-align: right;
            border-bottom-right-radius: 5px;
            color: #2c3e50;
        }

        .user-input {
            display: flex;
            padding: 20px;
            border-top: 1px solid #eee;
            background-color: #f9f9f9;
        }

        #question-form {
            display: flex;
            width: 100%;
            position: relative;
        }

        /* Auto-expanding input box */
        .textarea-container {
            flex: 1;
            position: relative;
            margin-right: 10px;
        }

        #user-question {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid #ddd;
            border-radius: 24px;
            font-size: 16px;
            min-height: 55px;
            max-height: 150px; /* Maximum height before scrolling */
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            resize: none; /* Disable manual resizing */
            overflow-y: auto; /* Enable scrolling for very long text */
            line-height: 1.4;
        }

        #user-question:focus {
            outline: none;
            border-color: #2c3e50;
            box-shadow: 0 0 0 2px rgba(44, 62, 80, 0.2);
        }

        button {
            background-color: #2c3e50;
            color: white;
            border: none;
            padding: 0 25px;
            border-radius: 24px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            height: 55px;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        button:hover {
            background-color: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        footer {
            text-align: center;
            font-size: 14px;
            color: #666;
            padding: 20px;
            border-top: 1px solid #eee;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .designer-info {
            margin-top: 10px;
            font-style: italic;
            color: #555;
        }

        .hk-emblem {
            position: absolute;
            right: 30px;
            top: 30px;
            width: 60px;
            height: 60px;
            opacity: 0.9;
        }

        /* Language classes for bilingual support */
        .en {
            margin-bottom: 5px;
        }
        
        .zh {
            margin-top: 5px;
            font-style: normal;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #c0c0c0;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a0a0a0;
        }

        /* Typing indicator animation */
        .typing-indicator {
            display: flex;
            padding: 15px 20px;
            border-radius: 18px;
            max-width: 85%;
            margin-bottom: 20px;
            background-color: #e6f2ff;
            border-bottom-left-radius: 5px;
        }

        .typing-indicator span {
            height: 10px;
            width: 10px;
            background-color: #2c3e50;
            border-radius: 50%;
            display: inline-block;
            margin: 0 3px;
            opacity: 0.6;
        }

        .typing-indicator span:nth-child(1) {
            animation: bounce 1s infinite 0.2s;
        }
        .typing-indicator span:nth-child(2) {
            animation: bounce 1s infinite 0.4s;
        }
        .typing-indicator span:nth-child(3) {
            animation: bounce 1s infinite 0.6s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            header {
                padding: 20px;
            }
            
            .chat-messages {
                height: 450px;
            }
            
            .message {
                max-width: 90%;
            }
            
            #user-question {
                font-size: 15px;
            }
            
            button {
                padding: 0 20px;
            }
            
            .hk-emblem {
                width: 40px;
                height: 40px;
                right: 20px;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 1.7rem;
            }
            
            header h2 {
                font-size: 1.3rem;
            }
            
            .chat-messages {
                height: 400px;
                padding: 15px;
            }
            
            .message {
                padding: 12px 15px;
                font-size: 15px;
            }
            
            .user-input {
                padding: 15px;
            }
            
            #user-question {
                padding: 12px 15px;
                min-height: 50px;
            }
            
            button {
                height: 50px;
                padding: 0 15px;
            }
            
            .logo-container {
                width: 150px;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <!-- LawPal Robot Icon -->
                <svg width="180" height="210" viewBox="0 0 300 350" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="hatGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#fbbf24"/>
                            <stop offset="100%" style="stop-color:#f59e0b"/>
                        </linearGradient>
                    </defs>
                    
                    <!-- Hard hat -->
                    <g transform="translate(150, 80)">
                        <ellipse cx="0" cy="0" rx="45" ry="15" fill="url(#hatGradient)"/>
                        <ellipse cx="0" cy="-10" rx="40" ry="12" fill="#fbbf24"/>
                        <rect x="-35" y="-8" width="70" height="12" fill="url(#hatGradient)"/>
                        <!-- Hat lamp -->
                        <circle cx="0" cy="-15" r="5" fill="#ffffff" stroke="#f59e0b" stroke-width="2"/>
                        <circle cx="0" cy="-15" r="3" fill="#fef3c7"/>
                    </g>
                    
                    <!-- Robot head -->
                    <g transform="translate(150, 140)">
                        <!-- Main head -->
                        <circle cx="0" cy="0" r="50" fill="#ffffff" stroke="#1e293b" stroke-width="4"/>
                        
                        <!-- Face screen area -->
                        <circle cx="0" cy="5" r="40" fill="#f8fafc" stroke="#64748b" stroke-width="2"/>
                        
                        <!-- Happy eyes -->
                        <circle cx="-15" cy="-8" r="8" fill="#1e293b"/>
                        <circle cx="15" cy="-8" r="8" fill="#1e293b"/>
                        
                        <!-- Eye highlights -->
                        <circle cx="-12" cy="-11" r="3" fill="#ffffff"/>
                        <circle cx="18" cy="-11" r="3" fill="#ffffff"/>
                        
                        <!-- Big friendly smile -->
                        <path d="M -20 15 Q 0 30 20 15" stroke="#1e293b" stroke-width="4" fill="none" stroke-linecap="round"/>
                        
                        <!-- Rosy cheeks -->
                        <circle cx="-25" cy="10" r="6" fill="#f87171" opacity="0.6"/>
                        <circle cx="25" cy="10" r="6" fill="#f87171" opacity="0.6"/>
                    </g>
                    
                    <!-- Simple body connected directly -->
                    <g transform="translate(150, 190)">
                        <rect x="-30" y="0" width="60" height="50" rx="15" fill="#1e293b" stroke="#0f172a" stroke-width="3"/>
                        <!-- Simple chest panel -->
                        <rect x="-20" y="15" width="40" height="20" rx="8" fill="#334155"/>
                        <!-- Single status light -->
                        <circle cx="0" cy="25" r="4" fill="#10b981"/>
                    </g>
                    
                    <!-- Bot name -->
                    <g transform="translate(150, 280)">
                        <text x="0" y="0" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#ffffff">
                            LawPal
                        </text>
                        <text x="0" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#ffffff" opacity="0.9">
                            勞工法助手
                        </text>
                    </g>
                </svg>
            </div>
            <h1>Hong Kong Employment Law Assistant</h1>
            <h2>香港勞工法助手</h2>
        </header>

        <div class="chat-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message">
                    <p class="en">What employment issue or question do you need help with today?</p>
                    <p class="zh">請問你今天需要幫助解決什麼僱傭問題或疑問？</p>
                </div>
                <!-- Messages will be added here dynamically -->
            </div>
            <div class="user-input">
                <form id="question-form">
                    <div class="textarea-container">
                        <textarea id="user-question" placeholder="Type your question here... / 請在此輸入您的問題..." rows="1"></textarea>
                    </div>
                    <button type="submit"><i class="fas fa-paper-plane"></i> Send</button>
                </form>
            </div>
        </div>

        <footer>
            <p>This chatbot provides general information on Hong Kong employment law and should not be considered legal advice. For specific legal issues, please consult a qualified lawyer.</p>
            <p>此聊天機器人僅提供香港勞工法的一般資訊，不應視為法律建議。如遇具體法律問題，請諮詢合資格律師。</p>
            <p class="designer-info">Designed by Sienna Ng &copy; 2025</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chat-messages');
            const questionForm = document.getElementById('question-form');
            const userQuestion = document.getElementById('user-question');

            // Auto-resize textarea as user types
            userQuestion.addEventListener('input', function() {
                // Reset height to auto to get the correct scrollHeight
                this.style.height = 'auto';
                
                // Set new height based on scrollHeight but cap it at max-height
                const newHeight = Math.min(this.scrollHeight, 150);
                this.style.height = newHeight + 'px';
            });

            // Function to add messages to the chat
            function addMessage(message, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user-message' : 'bot-message');
                messageDiv.textContent = message;
                chatMessages.appendChild(messageDiv);
                
                // Scroll to the bottom of the chat
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Add typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.classList.add('typing-indicator');
                typingDiv.id = 'typing-indicator';
                
                for (let i = 0; i < 3; i++) {
                    const dot = document.createElement('span');
                    typingDiv.appendChild(dot);
                }
                
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                return typingDiv;
            }

            // Process the user's question
            questionForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const question = userQuestion.value.trim();
                if (!question) return;
                
                // Add user message
                addMessage(question, true);
                
                // Clear input and reset height
                userQuestion.value = '';
                userQuestion.style.height = '55px';
                
                // Show typing indicator
                const typingIndicator = showTypingIndicator();
                
                // In a real implementation, we would call your Flask backend here
                // For demonstration, simulate a request to your /ask endpoint
                
                // Using the actual API endpoint from your Flask app
                fetch('/ask', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ question: question }),
                })
                .then(response => response.json())
                .then(data => {
                    // Remove typing indicator
                    typingIndicator.remove();
                    
                    // Add bot response from the API
                    if (data.response) {
                        addMessage(data.response);
                    } else if (data.error) {
                        addMessage("Sorry, I encountered an error: " + data.error);
                    }
                })
                .catch(error => {
                    // Remove typing indicator
                    typingIndicator.remove();
                    
                    console.error('Error:', error);
                    
                    // Fallback to local responses if API call fails
                    const response = getFallbackResponse(question);
                    addMessage(response);
                });
            });

            // Fallback response function when API is unavailable
            function getFallbackResponse(question) {
                // Simple keyword matching for demonstration
                question = question.toLowerCase();
                
                if (question.includes('contract') || question.includes('agreement')) {
                    return "Employment contracts in Hong Kong should include terms like job title, wages, working hours, and notice period. Written contracts are not mandatory but highly recommended.";
                } else if (question.includes('notice') || question.includes('termination')) {
                    return "The minimum notice period in Hong Kong is generally 1 month, unless specified otherwise in the employment contract. For employees during probation, different rules may apply.";
                } else if (question.includes('leave') || question.includes('holiday')) {
                    return "Employees are entitled to a minimum of 7 days of paid annual leave after 12 months of employment, increasing progressively to a maximum of 14 days based on years of service.";
                } else if (question.includes('working hours') || question.includes('overtime')) {
                    return "Hong Kong does not have statutory standard working hours or overtime pay regulations. These terms should be agreed upon in the employment contract.";
                } else if (question.includes('mpf') || question.includes('pension')) {
                    return "Both employers and employees must contribute to the Mandatory Provident Fund (MPF). The current contribution rate is 5% of the employee's relevant income, subject to minimum and maximum thresholds.";
                } else {
                    return "I'm here to help with Hong Kong employment law questions. You can ask about contracts, termination, leave entitlements, MPF, maternity rights, and more. Could you please provide more details about your question?";
                }
            }

            // Focus the input field when the page loads
            userQuestion.focus();
        });
    </script>
</body>
</html>